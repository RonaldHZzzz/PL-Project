{% extends 'base.html' %}

{% block title %}Mis Trabajos{% endblock %}

{% block header %}
<h1 class="text-xl md:text-2xl font-bold tracking-tight text-gray-900">Trabajos</h1>
{% endblock %}

{% block content %}
<div class="mx-auto max-w-5xl px-4 py-6 sm:px-6 lg:px-8">
    <div class="bg-white p-4 md:p-6 rounded-md shadow-md">
        <!-- Filtro de fechas -->
        <div class="flex flex-wrap justify-between items-center pb-4">
            <h2 class="text-gray-600 font-semibold text-sm md:text-base">Trabajos Recientes</h2>
            <form method="GET" action="{% url 'jobs' %}" class="flex flex-wrap items-center gap-4 mt-2 md:mt-0" id="filter-form">
                <!-- Desde -->
                <div class="flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0">
                    <label for="from-date" class="text-gray-600 text-xs md:text-sm md:mr-2">Desde:</label>
                    <input id="from-date" name="from-date" type="date" class="border rounded-md px-2 py-1 text-xs md:text-sm" onchange="checkAndSubmit()" />
                </div>
                <!-- Hasta -->
                <div class="flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0">
                    <label for="to-date" class="text-gray-600 text-xs md:text-sm md:mr-2">Hasta:</label>
                    <input id="to-date" name="to-date" type="date" class="border rounded-md px-2 py-1 text-xs md:text-sm" onchange="checkAndSubmit()" />
                </div>
            </form>
        </div>

        <!-- Tabla -->
        <div class="overflow-x-auto">
            <table class="min-w-full bg-white shadow-md rounded-lg">
                <thead class="bg-pink-200">
                    <tr>
                        <th class="text-left px-2 md:px-4 py-2 text-xs md:text-sm font-semibold text-gray-700">Usuario</th>
                        <th class="text-left px-2 md:px-4 py-2 text-xs md:text-sm font-semibold text-gray-700">Trabajo</th>
                        <th class="text-left px-2 md:px-4 py-2 text-xs md:text-sm font-semibold text-gray-700">Fecha</th>
                        <th class="text-left px-2 md:px-4 py-2 text-xs md:text-sm font-semibold text-gray-700">Precio</th>
                    </tr>
                </thead>
                <tbody>
                    {% for trabajo in trabajos %}
                    <tr class="border-b">
                        <td class="px-2 md:px-4 py-2 text-xs md:text-sm text-gray-800">{{ trabajo.usuario.username }}</td>
                        <td class="px-2 md:px-4 py-2 text-xs md:text-sm text-gray-800">{{ trabajo.trabajo }}</td>
                        <td class="px-2 md:px-4 py-2 text-xs md:text-sm text-gray-800">{{ trabajo.fecha_registro }}</td>
                        <td class="px-2 md:px-4 py-2 text-xs md:text-sm text-gray-800">${{ trabajo.monto }}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" class="text-center px-2 md:px-4 py-2 text-xs md:text-sm text-gray-600">No hay trabajos registrados.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    function checkAndSubmit() {
        // Obtener los valores de las fechas
        var fromDate = document.getElementById("from-date").value;
        var toDate = document.getElementById("to-date").value;

        // Verificar si ambos campos tienen valores
        if (fromDate && toDate) {
            // Si ambos están completos, enviar el formulario automáticamente
            document.getElementById("filter-form").submit();
        }
    }
</script>

{% endblock %}
